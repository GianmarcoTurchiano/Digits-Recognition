schema: '2.0'
stages:
  download:
    cmd: python digits_recognition/dataset/download.py -o ./data/raw/archive.zip
    deps:
    - path: digits_recognition/dataset/download.py
      hash: md5
      md5: 3875c97b92080ac1e058a3ab59ac45e3
      size: 527
      isexec: true
    outs:
    - path: ./data/raw/archive.zip
      hash: md5
      md5: 72a645a3fd2da4fd0adc12c5f38956d0
      size: 23112702
      isexec: true
  extract:
    cmd: python digits_recognition/dataset/extract.py -z ./data/raw/archive.zip -o
      ./data/interim/unzipped
    deps:
    - path: ./data/raw/archive.zip
      hash: md5
      md5: 72a645a3fd2da4fd0adc12c5f38956d0
      size: 23112702
      isexec: true
    - path: digits_recognition/dataset/extract.py
      hash: md5
      md5: efdbbd6002b00aff29fe664d1447c227
      size: 633
      isexec: true
    outs:
    - path: ./data/interim/unzipped
      hash: md5
      md5: 7e0914f66dbe3c1571a44a806ddc1907.dir
      size: 109900096
      nfiles: 8
  split:
    cmd: python digits_recognition/dataset/split.py -p ./data/interim/unzipped -tr
      ./data/processed/train_set.pkl -ts ./data/processed/test_set.pkl -v ./data/processed/val_set.pkl
      --split_seed 42 --validation_ratio 0.15
    deps:
    - path: ./data/interim/unzipped
      hash: md5
      md5: 7e0914f66dbe3c1571a44a806ddc1907.dir
      size: 109900096
      nfiles: 8
    - path: digits_recognition/dataset/split.py
      hash: md5
      md5: b16f40c9603d2e0793d65dff2f9c36fd
      size: 2459
      isexec: true
    outs:
    - path: ./data/processed/test_set.pkl
      hash: md5
      md5: 5bca9cc2dfb6e121ecb7b9e39759d839
      size: 7850211
      isexec: true
    - path: ./data/processed/train_set.pkl
      hash: md5
      md5: 28354a357efaad41363ae691aa5575a6
      size: 40035211
      isexec: true
    - path: ./data/processed/val_set.pkl
      hash: md5
      md5: e7b6281b2cbe1c052ab286b3c8837342
      size: 7065211
      isexec: true
  train:
    cmd: python digits_recognition/modeling/train.py -t ./data/processed/train_set.pkl
      -v ./data/processed/val_set.pkl -m ./models/digit_classifier.pth --patience
      1 --epochs 100 --learning_rate 0.001 --weight_decay 1e-2 --random_seed 42 --batch_size
      64 --polynomial_scheduler_power 4.0
    deps:
    - path: ./data/processed/train_set.pkl
      hash: md5
      md5: 28354a357efaad41363ae691aa5575a6
      size: 40035211
      isexec: true
    - path: ./data/processed/val_set.pkl
      hash: md5
      md5: e7b6281b2cbe1c052ab286b3c8837342
      size: 7065211
      isexec: true
    - path: digits_recognition/load_dataset.py
      hash: md5
      md5: 19be58d10b4ab8f40c9dbf1d3b3b3024
      size: 548
      isexec: true
    - path: digits_recognition/mlflow_setup.py
      hash: md5
      md5: d4b417bcb44cc9e792cde80c85371b31
      size: 389
      isexec: true
    - path: digits_recognition/modeling/classifier.py
      hash: md5
      md5: b78a344fd0c494c6043a9cb04bc5dd0b
      size: 568
      isexec: true
    - path: digits_recognition/modeling/train.py
      hash: md5
      md5: 4cee0df2590d8a9de2b25217509f856f
      size: 4382
      isexec: true
    outs:
    - path: ./models/digit_classifier.pth
      hash: md5
      md5: 7fb4ea7e0397b578c622baf407393dbf
      size: 475874
      isexec: true
  evaluate:
    cmd: python digits_recognition/modeling/evaluate.py -t ./data/processed/test_set.pkl
      -m ./models/digit_classifier.pth --batch_size 64
    deps:
    - path: ./data/processed/test_set.pkl
      hash: md5
      md5: 5bca9cc2dfb6e121ecb7b9e39759d839
      size: 7850211
      isexec: true
    - path: ./models/digit_classifier.pth
      hash: md5
      md5: 7fb4ea7e0397b578c622baf407393dbf
      size: 475874
      isexec: true
    - path: digits_recognition/load_dataset.py
      hash: md5
      md5: 19be58d10b4ab8f40c9dbf1d3b3b3024
      size: 548
      isexec: true
    - path: digits_recognition/mlflow_setup.py
      hash: md5
      md5: d4b417bcb44cc9e792cde80c85371b31
      size: 389
      isexec: true
    - path: digits_recognition/modeling/classifier.py
      hash: md5
      md5: b78a344fd0c494c6043a9cb04bc5dd0b
      size: 568
      isexec: true
    - path: digits_recognition/modeling/evaluate.py
      hash: md5
      md5: 862c232650d8d3186d51b3fc782a297f
      size: 2421
      isexec: true
