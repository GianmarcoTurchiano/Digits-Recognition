schema: '2.0'
stages:
  download:
    cmd: python digits_recognition/dataset/download.py -o ./data/raw/archive.zip
    deps:
    - path: digits_recognition/dataset/download.py
      hash: md5
      md5: c830cd8c0db305e8ab44c073d23b1aef
      size: 784
      isexec: true
    outs:
    - path: ./data/raw/archive.zip
      hash: md5
      md5: 72a645a3fd2da4fd0adc12c5f38956d0
      size: 23112702
      isexec: true
  extract:
    cmd: python digits_recognition/dataset/extract.py -z ./data/raw/archive.zip -o
      ./data/interim/unzipped
    deps:
    - path: ./data/raw/archive.zip
      hash: md5
      md5: 72a645a3fd2da4fd0adc12c5f38956d0
      size: 23112702
      isexec: true
    - path: digits_recognition/dataset/extract.py
      hash: md5
      md5: 940507da356c7e390e1edf9df5549afe
      size: 693
      isexec: true
    outs:
    - path: ./data/interim/unzipped
      hash: md5
      md5: 7e0914f66dbe3c1571a44a806ddc1907.dir
      size: 109900096
      nfiles: 8
  split:
    cmd: python digits_recognition/dataset/split.py -p ./data/interim/unzipped -tr
      ./data/processed/train_set.pkl -ts ./data/processed/test_set.pkl -v ./data/processed/val_set.pkl
      --split_seed 42 --validation_ratio 0.15
    deps:
    - path: ./data/interim/unzipped
      hash: md5
      md5: 7e0914f66dbe3c1571a44a806ddc1907.dir
      size: 109900096
      nfiles: 8
    - path: digits_recognition/dataset/split.py
      hash: md5
      md5: 17d5a96f1faf4fd1926dc0f6dfe8a040
      size: 2818
      isexec: true
    outs:
    - path: ./data/processed/test_set.pkl
      hash: md5
      md5: 5bca9cc2dfb6e121ecb7b9e39759d839
      size: 7850211
      isexec: true
    - path: ./data/processed/train_set.pkl
      hash: md5
      md5: 28354a357efaad41363ae691aa5575a6
      size: 40035211
      isexec: true
    - path: ./data/processed/val_set.pkl
      hash: md5
      md5: e7b6281b2cbe1c052ab286b3c8837342
      size: 7065211
      isexec: true
  train:
    cmd: python digits_recognition/modeling/train.py -t ./data/processed/train_set.pkl
      -v ./data/processed/val_set.pkl -m ./models/digit_classifier.pth --patience
      10 --epochs 100 --learning_rate 0.001 --weight_decay 2e-3 --random_seed 42 --batch_size
      64 --polynomial_scheduler_power 4.0
    deps:
    - path: ./data/processed/train_set.pkl
      hash: md5
      md5: 28354a357efaad41363ae691aa5575a6
      size: 40035211
      isexec: true
    - path: ./data/processed/val_set.pkl
      hash: md5
      md5: e7b6281b2cbe1c052ab286b3c8837342
      size: 7065211
      isexec: true
    - path: digits_recognition/load_dataset.py
      hash: md5
      md5: 2618b3e1e3bc49850be3c90a03b9b1f7
      size: 2577
      isexec: true
    - path: digits_recognition/mlflow_setup.py
      hash: md5
      md5: af6413bf69a024cab147327f6822c7a6
      size: 525
      isexec: true
    - path: digits_recognition/modeling/classifier.py
      hash: md5
      md5: d8ab6344c6234f2188c9c0f4f4ce446d
      size: 1712
      isexec: true
    - path: digits_recognition/modeling/train.py
      hash: md5
      md5: 78e4580a438b2e5047a3dafc2625c370
      size: 6572
      isexec: true
    - path: digits_recognition/training_inference.py
      hash: md5
      md5: fd588e8fb5779cc21e0866bfbcf31113
      size: 691
      isexec: true
    outs:
    - path: ./models/digit_classifier.pth
      hash: md5
      md5: 91acfe06833cff8272856662b1fd1fdd
      size: 1107318
      isexec: true
  evaluate:
    cmd: python digits_recognition/modeling/evaluate.py -t ./data/processed/test_set.pkl
      -m ./models/digit_classifier.pth --batch_size 64
    deps:
    - path: ./data/processed/test_set.pkl
      hash: md5
      md5: 5bca9cc2dfb6e121ecb7b9e39759d839
      size: 7850211
      isexec: true
    - path: ./models/digit_classifier.pth
      hash: md5
      md5: 91acfe06833cff8272856662b1fd1fdd
      size: 1107318
      isexec: true
    - path: digits_recognition/evaluation_inference.py
      hash: md5
      md5: a51f927893071ee8028f83c0219a6ef3
      size: 707
      isexec: true
    - path: digits_recognition/load_dataset.py
      hash: md5
      md5: 2618b3e1e3bc49850be3c90a03b9b1f7
      size: 2577
      isexec: true
    - path: digits_recognition/mlflow_setup.py
      hash: md5
      md5: af6413bf69a024cab147327f6822c7a6
      size: 525
      isexec: true
    - path: digits_recognition/modeling/classifier.py
      hash: md5
      md5: d8ab6344c6234f2188c9c0f4f4ce446d
      size: 1712
      isexec: true
    - path: digits_recognition/modeling/evaluate.py
      hash: md5
      md5: 33233eb6da8623cea0b0ab6566b30262
      size: 3375
      isexec: true
    - path: digits_recognition/training_inference.py
      hash: md5
      md5: fd588e8fb5779cc21e0866bfbcf31113
      size: 691
      isexec: true
