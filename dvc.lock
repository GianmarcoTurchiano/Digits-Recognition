schema: '2.0'
stages:
  download:
    cmd: python digits_recognition/dataset/download.py -o ./data/raw/archive.zip
    deps:
    - path: digits_recognition/dataset/download.py
      hash: md5
      md5: c830cd8c0db305e8ab44c073d23b1aef
      size: 784
      isexec: true
    outs:
    - path: ./data/raw/archive.zip
      hash: md5
      md5: 72a645a3fd2da4fd0adc12c5f38956d0
      size: 23112702
      isexec: true
  extract:
    cmd: python digits_recognition/dataset/extract.py -z ./data/raw/archive.zip -o
      ./data/interim/unzipped
    deps:
    - path: ./data/raw/archive.zip
      hash: md5
      md5: 72a645a3fd2da4fd0adc12c5f38956d0
      size: 23112702
      isexec: true
    - path: digits_recognition/dataset/extract.py
      hash: md5
      md5: 940507da356c7e390e1edf9df5549afe
      size: 693
      isexec: true
    outs:
    - path: ./data/interim/unzipped
      hash: md5
      md5: 7e0914f66dbe3c1571a44a806ddc1907.dir
      size: 109900096
      nfiles: 8
  split:
    cmd: python digits_recognition/dataset/split.py -p ./data/interim/unzipped -tr
      ./data/processed/train_set.pkl -ts ./data/processed/test_set.pkl -v ./data/processed/val_set.pkl
      --split_seed 42 --validation_ratio 0.15
    deps:
    - path: ./data/interim/unzipped
      hash: md5
      md5: 7e0914f66dbe3c1571a44a806ddc1907.dir
      size: 109900096
      nfiles: 8
    - path: digits_recognition/dataset/split.py
      hash: md5
      md5: 17d5a96f1faf4fd1926dc0f6dfe8a040
      size: 2818
      isexec: true
    outs:
    - path: ./data/processed/test_set.pkl
      hash: md5
      md5: 5bca9cc2dfb6e121ecb7b9e39759d839
      size: 7850211
      isexec: true
    - path: ./data/processed/train_set.pkl
      hash: md5
      md5: 28354a357efaad41363ae691aa5575a6
      size: 40035211
      isexec: true
    - path: ./data/processed/val_set.pkl
      hash: md5
      md5: e7b6281b2cbe1c052ab286b3c8837342
      size: 7065211
      isexec: true
  train:
    cmd: python digits_recognition/modeling/train.py -t ./data/processed/train_set.pkl
      -v ./data/processed/val_set.pkl -m ./models/digit_classifier.pth --patience
      10 --epochs 100 --learning_rate 0.001 --weight_decay 1e-2 --random_seed 42 --batch_size
      64 --polynomial_scheduler_power 4.5
    deps:
    - path: ./data/processed/train_set.pkl
      hash: md5
      md5: 28354a357efaad41363ae691aa5575a6
      size: 40035211
      isexec: true
    - path: ./data/processed/val_set.pkl
      hash: md5
      md5: e7b6281b2cbe1c052ab286b3c8837342
      size: 7065211
      isexec: true
    - path: digits_recognition/load_dataset.py
      hash: md5
      md5: fa21bc58d12a3f52b31e42b35f715388
      size: 1969
      isexec: true
    - path: digits_recognition/mlflow_setup.py
      hash: md5
      md5: 45bd954359eed9d22753f77fffdaa268
      size: 510
      isexec: true
    - path: digits_recognition/modeling/classifier.py
      hash: md5
      md5: 4a12112d2b100fc56271d8ec87aaa6ec
      size: 704
      isexec: true
    - path: digits_recognition/modeling/train.py
      hash: md5
      md5: 2dd45a91a259cb3f33857dc863d176ab
      size: 4917
      isexec: true
    outs:
    - path: ./models/digit_classifier.pth
      hash: md5
      md5: 3068e1c8eab958c05422205d31c95a65
      size: 475874
      isexec: true
  evaluate:
    cmd: python digits_recognition/modeling/evaluate.py -t ./data/processed/test_set.pkl
      -m ./models/digit_classifier.pth --batch_size 64
    deps:
    - path: ./data/processed/test_set.pkl
      hash: md5
      md5: 5bca9cc2dfb6e121ecb7b9e39759d839
      size: 7850211
      isexec: true
    - path: ./models/digit_classifier.pth
      hash: md5
      md5: 3068e1c8eab958c05422205d31c95a65
      size: 475874
      isexec: true
    - path: digits_recognition/load_dataset.py
      hash: md5
      md5: fa21bc58d12a3f52b31e42b35f715388
      size: 1969
      isexec: true
    - path: digits_recognition/mlflow_setup.py
      hash: md5
      md5: 45bd954359eed9d22753f77fffdaa268
      size: 510
      isexec: true
    - path: digits_recognition/modeling/classifier.py
      hash: md5
      md5: 4a12112d2b100fc56271d8ec87aaa6ec
      size: 704
      isexec: true
    - path: digits_recognition/modeling/evaluate.py
      hash: md5
      md5: b07ad95af142994c16d321d5cc096fd6
      size: 2518
      isexec: true
